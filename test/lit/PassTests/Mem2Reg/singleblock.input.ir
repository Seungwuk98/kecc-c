// RUN: kecc-opt %s --canonicalize-constant --mem2reg | FileCheck %s

fun i32 @single_block () {
// CHECK: fun i32 @single_block
init:
  bid: b0
  allocations:
    %l0:i32:x
// CHECK-NEXT: init:
// CHECK-NEXT:   bid: b0
// CHECK-NEXT:   allocations:
// CHECK-NEXT:   %l0:i32:x


block b0:
// CHECK-LABEL: block b0:
  %b0:i0:i32 = load %l0:i32*
  // CHECK-NEXT: %b0:i0:unit = nop 

  %b0:i1:unit = store 42:i32 %l0:i32*
  // CHECK-NEXT: %b0:i1:unit = nop 
  %b0:i2:i32 = load %l0:i32*
  // CHECK-NEXT: %b0:i2:unit = nop 

  %b0:i3:unit = store 37:i32 %l0:i32*
  // CHECK-NEXT: %b0:i3:unit = nop 
  %b0:i4:i32 = load %l0:i32*
  // CHECK-NEXT: %b0:i4:unit = nop 

  %b0:i5:unit = call @sink:[ret:unit params:(i32)]*(%b0:i0:i32)
  // CHECK-NEXT: %b0:i5:unit = call @sink:[ret:unit params:(i32)]*(undef:i32)
  %b0:i6:unit = call @sink:[ret:unit params:(i32)]*(%b0:i2:i32)
  // CHECK-NEXT: %b0:i6:unit = call @sink:[ret:unit params:(i32)]*(42:i32)
  %b0:i7:unit = call @sink:[ret:unit params:(i32)]*(%b0:i4:i32)
  // CHECK-NEXT: %b0:i7:unit = call @sink:[ret:unit params:(i32)]*(37:i32)

  ret 0:i32
  // CHECK-NEXT: ret 0:i32
}
// CHECK-NEXT: } 
